{"ast":null,"code":"import { __awaiter, __generator, __values, __read, __assign, __extends, __spreadArray } from 'tslib';\nimport { Point, findClosestClipPathTarget, isFillOrStrokeAffected, getOrCalculatePathTotalLength, Shape, AbstractRendererPlugin } from '@antv/g-lite';\nimport { vec3, mat4 } from 'gl-matrix';\nimport { distance, linePointToLine, cubicPointDistance, quadPointDistance } from '@antv/g-math';\nimport { arcToCubic, clamp } from '@antv/util';\nvar tmpVec3a = vec3.create();\nvar tmpVec3b = vec3.create();\nvar tmpVec3c = vec3.create();\nvar tmpMat4 = mat4.create();\n/**\n * pick shape(s) with Mouse/Touch event\n *\n * 1. find AABB with r-tree\n * 2. do math calculation with geometry in an accurate way\n */\nvar CanvasPickerPlugin = /** @class */function () {\n  function CanvasPickerPlugin() {\n    var _this = this;\n    this.isHit = function (displayObject, position, worldTransform, isClipPath) {\n      // use picker for current shape's type\n      var pick = _this.context.pointInPathPickerFactory[displayObject.nodeName];\n      if (pick) {\n        // invert with world matrix\n        var invertWorldMat = mat4.invert(tmpMat4, worldTransform);\n        // transform client position to local space, do picking in local space\n        var localPosition = vec3.transformMat4(tmpVec3b, vec3.set(tmpVec3c, position[0], position[1], 0), invertWorldMat);\n        if (pick(displayObject, new Point(localPosition[0], localPosition[1]), isClipPath, _this.isPointInPath, _this.context, _this.runtime)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    /**\n     * use native picking method\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/isPointInPath\n     */\n    this.isPointInPath = function (displayObject, position) {\n      var context = _this.runtime.offscreenCanvasCreator.getOrCreateContext(_this.context.config.offscreenCanvas);\n      var generatePath = _this.context.pathGeneratorFactory[displayObject.nodeName];\n      if (generatePath) {\n        context.beginPath();\n        generatePath(context, displayObject.parsedStyle);\n        context.closePath();\n      }\n      return context.isPointInPath(position.x, position.y);\n    };\n  }\n  CanvasPickerPlugin.prototype.apply = function (context, runtime) {\n    var _this = this;\n    var _a;\n    var renderingService = context.renderingService,\n      renderingContext = context.renderingContext;\n    this.context = context;\n    this.runtime = runtime;\n    var document = (_a = renderingContext.root) === null || _a === void 0 ? void 0 : _a.ownerDocument;\n    renderingService.hooks.pick.tapPromise(CanvasPickerPlugin.tag, function (result) {\n      return __awaiter(_this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n          return [2 /*return*/, this.pick(document, result)];\n        });\n      });\n    });\n    renderingService.hooks.pickSync.tap(CanvasPickerPlugin.tag, function (result) {\n      return _this.pick(document, result);\n    });\n  };\n  CanvasPickerPlugin.prototype.pick = function (document, result) {\n    var e_1, _a;\n    var topmost = result.topmost,\n      _b = result.position,\n      x = _b.x,\n      y = _b.y;\n    // position in world space\n    var position = vec3.set(tmpVec3a, x, y, 0);\n    // query by AABB first with spatial index(r-tree)\n    var hitTestList = document.elementsFromBBox(position[0], position[1], position[0], position[1]);\n    // test with clip path & origin shape\n    // @see https://github.com/antvis/g/issues/1064\n    var pickedDisplayObjects = [];\n    try {\n      for (var hitTestList_1 = __values(hitTestList), hitTestList_1_1 = hitTestList_1.next(); !hitTestList_1_1.done; hitTestList_1_1 = hitTestList_1.next()) {\n        var displayObject = hitTestList_1_1.value;\n        var worldTransform = displayObject.getWorldTransform();\n        var isHitOriginShape = this.isHit(displayObject, position, worldTransform, false);\n        if (isHitOriginShape) {\n          // should look up in the ancestor node\n          var clipped = findClosestClipPathTarget(displayObject);\n          if (clipped) {\n            var clipPath = clipped.parsedStyle.clipPath;\n            var isHitClipPath = this.isHit(clipPath, position, clipPath.getWorldTransform(), true);\n            if (isHitClipPath) {\n              if (topmost) {\n                result.picked = [displayObject];\n                return result;\n              } else {\n                pickedDisplayObjects.push(displayObject);\n              }\n            }\n          } else {\n            if (topmost) {\n              result.picked = [displayObject];\n              return result;\n            } else {\n              pickedDisplayObjects.push(displayObject);\n            }\n          }\n        }\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (hitTestList_1_1 && !hitTestList_1_1.done && (_a = hitTestList_1.return)) _a.call(hitTestList_1);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n    result.picked = pickedDisplayObjects;\n    return result;\n  };\n  CanvasPickerPlugin.tag = 'CanvasPicker';\n  return CanvasPickerPlugin;\n}();\nfunction isPointInPath$7(displayObject, position, isClipPath) {\n  var _a = displayObject.parsedStyle,\n    _b = _a.cx,\n    cx = _b === void 0 ? 0 : _b,\n    _c = _a.cy,\n    cy = _c === void 0 ? 0 : _c,\n    r = _a.r,\n    fill = _a.fill,\n    stroke = _a.stroke,\n    _d = _a.lineWidth,\n    lineWidth = _d === void 0 ? 1 : _d,\n    _e = _a.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _e === void 0 ? 0 : _e,\n    _f = _a.pointerEvents,\n    pointerEvents = _f === void 0 ? 'auto' : _f;\n  var halfLineWidth = (lineWidth + increasedLineWidthForHitTesting) / 2;\n  var absDistance = distance(cx, cy, position.x, position.y);\n  var _g = __read(isFillOrStrokeAffected(pointerEvents, fill, stroke), 2),\n    hasFill = _g[0],\n    hasStroke = _g[1];\n  if (hasFill && hasStroke || isClipPath) {\n    return absDistance <= r + halfLineWidth;\n  }\n  if (hasFill) {\n    return absDistance <= r;\n  }\n  if (hasStroke) {\n    return absDistance >= r - halfLineWidth && absDistance <= r + halfLineWidth;\n  }\n  return false;\n}\nfunction ellipseDistance(squareX, squareY, rx, ry) {\n  return squareX / (rx * rx) + squareY / (ry * ry);\n}\nfunction isPointInPath$6(displayObject, position, isClipPath) {\n  var _a = displayObject.parsedStyle,\n    _b = _a.cx,\n    cx = _b === void 0 ? 0 : _b,\n    _c = _a.cy,\n    cy = _c === void 0 ? 0 : _c,\n    rx = _a.rx,\n    ry = _a.ry,\n    fill = _a.fill,\n    stroke = _a.stroke,\n    _d = _a.lineWidth,\n    lineWidth = _d === void 0 ? 1 : _d,\n    _e = _a.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _e === void 0 ? 0 : _e,\n    _f = _a.pointerEvents,\n    pointerEvents = _f === void 0 ? 'auto' : _f;\n  var x = position.x,\n    y = position.y;\n  var _g = __read(isFillOrStrokeAffected(pointerEvents, fill, stroke), 2),\n    hasFill = _g[0],\n    hasStroke = _g[1];\n  var halfLineWith = (lineWidth + increasedLineWidthForHitTesting) / 2;\n  var squareX = (x - cx) * (x - cx);\n  var squareY = (y - cy) * (y - cy);\n  // 使用椭圆的公式： x*x/rx*rx + y*y/ry*ry = 1;\n  if (hasFill && hasStroke || isClipPath) {\n    return ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <= 1;\n  }\n  if (hasFill) {\n    return ellipseDistance(squareX, squareY, rx, ry) <= 1;\n  }\n  if (hasStroke) {\n    return ellipseDistance(squareX, squareY, rx - halfLineWith, ry - halfLineWith) >= 1 && ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <= 1;\n  }\n  return false;\n}\nfunction inBox(minX, minY, width, height, x, y) {\n  return x >= minX && x <= minX + width && y >= minY && y <= minY + height;\n}\nfunction inRect(minX, minY, width, height, lineWidth, x, y) {\n  var halfWidth = lineWidth / 2;\n  // 将四个边看做矩形来检测，比边的检测算法要快\n  return inBox(minX - halfWidth, minY - halfWidth, width, lineWidth, x, y) ||\n  // 上边\n  inBox(minX + width - halfWidth, minY - halfWidth, lineWidth, height, x, y) ||\n  // 右边\n  inBox(minX + halfWidth, minY + height - halfWidth, width, lineWidth, x, y) ||\n  // 下边\n  inBox(minX - halfWidth, minY + halfWidth, lineWidth, height, x, y); // 左边\n}\nfunction inArc(cx, cy, r, startAngle, endAngle, lineWidth, x, y) {\n  var angle = (Math.atan2(y - cy, x - cx) + Math.PI * 2) % (Math.PI * 2); // 转换到 0 - 2 * Math.PI 之间\n  // if (angle < startAngle || angle > endAngle) {\n  //   return false;\n  // }\n  var point = {\n    x: cx + r * Math.cos(angle),\n    y: cy + r * Math.sin(angle)\n  };\n  return distance(point.x, point.y, x, y) <= lineWidth / 2;\n}\nfunction inLine(x1, y1, x2, y2, lineWidth, x, y) {\n  var minX = Math.min(x1, x2);\n  var maxX = Math.max(x1, x2);\n  var minY = Math.min(y1, y2);\n  var maxY = Math.max(y1, y2);\n  var halfWidth = lineWidth / 2;\n  // 因为目前的方案是计算点到直线的距离，而有可能会在延长线上，所以要先判断是否在包围盒内\n  // 这种方案会在水平或者竖直的情况下载线的延长线上有半 lineWidth 的误差\n  if (!(x >= minX - halfWidth && x <= maxX + halfWidth && y >= minY - halfWidth && y <= maxY + halfWidth)) {\n    return false;\n  }\n  // 因为已经计算了包围盒，所以仅需要计算到直线的距离即可，可以显著提升性能\n  return linePointToLine(x1, y1, x2, y2, x, y) <= lineWidth / 2;\n}\nfunction inPolyline(points, lineWidth, x, y, isClose) {\n  var count = points.length;\n  if (count < 2) {\n    return false;\n  }\n  for (var i = 0; i < count - 1; i++) {\n    var x1 = points[i][0];\n    var y1 = points[i][1];\n    var x2 = points[i + 1][0];\n    var y2 = points[i + 1][1];\n    if (inLine(x1, y1, x2, y2, lineWidth, x, y)) {\n      return true;\n    }\n  }\n  // 如果封闭，则计算起始点和结束点的边\n  if (isClose) {\n    var first = points[0];\n    var last = points[count - 1];\n    if (inLine(first[0], first[1], last[0], last[1], lineWidth, x, y)) {\n      return true;\n    }\n  }\n  return false;\n}\n// 多边形的射线检测，参考：https://blog.csdn.net/WilliamSun0122/article/details/77994526\nvar tolerance = 1e-6;\n// 三态函数，判断两个double在eps精度下的大小关系\nfunction dcmp(x) {\n  if (Math.abs(x) < tolerance) {\n    return 0;\n  }\n  return x < 0 ? -1 : 1;\n}\n// 判断点Q是否在p1和p2的线段上\nfunction onSegment(p1, p2, q) {\n  if ((q[0] - p1[0]) * (p2[1] - p1[1]) === (p2[0] - p1[0]) * (q[1] - p1[1]) && Math.min(p1[0], p2[0]) <= q[0] && q[0] <= Math.max(p1[0], p2[0]) && Math.min(p1[1], p2[1]) <= q[1] && q[1] <= Math.max(p1[1], p2[1])) {\n    return true;\n  }\n  return false;\n}\n// 判断点P在多边形内-射线法\nfunction inPolygon(points, x, y) {\n  var isHit = false;\n  var n = points.length;\n  if (n <= 2) {\n    // svg 中点小于 3 个时，不显示，也无法被拾取\n    return false;\n  }\n  for (var i = 0; i < n; i++) {\n    var p1 = points[i];\n    var p2 = points[(i + 1) % n];\n    if (onSegment(p1, p2, [x, y])) {\n      // 点在多边形一条边上\n      return true;\n    }\n    // 前一个判断min(p1[1],p2[1])<P.y<=max(p1[1],p2[1])\n    // 后一个判断被测点 在 射线与边交点 的左边\n    if (dcmp(p1[1] - y) > 0 !== dcmp(p2[1] - y) > 0 && dcmp(x - (y - p1[1]) * (p1[0] - p2[0]) / (p1[1] - p2[1]) - p1[0]) < 0) {\n      isHit = !isHit;\n    }\n  }\n  return isHit;\n}\nfunction inPolygons(polygons, x, y) {\n  var isHit = false;\n  for (var i = 0; i < polygons.length; i++) {\n    var points = polygons[i];\n    isHit = inPolygon(points, x, y);\n    if (isHit) {\n      break;\n    }\n  }\n  return isHit;\n}\nfunction isPointInPath$5(displayObject, position, isClipPath) {\n  var _a = displayObject.parsedStyle,\n    x1 = _a.x1,\n    y1 = _a.y1,\n    x2 = _a.x2,\n    y2 = _a.y2,\n    _b = _a.lineWidth,\n    lineWidth = _b === void 0 ? 1 : _b,\n    _c = _a.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _c === void 0 ? 0 : _c,\n    _d = _a.pointerEvents,\n    pointerEvents = _d === void 0 ? 'auto' : _d,\n    fill = _a.fill,\n    stroke = _a.stroke;\n  var _e = __read(isFillOrStrokeAffected(pointerEvents, fill, stroke), 2),\n    hasStroke = _e[1];\n  if (!hasStroke && !isClipPath || !lineWidth) {\n    return false;\n  }\n  return inLine(x1, y1, x2, y2, lineWidth + increasedLineWidthForHitTesting, position.x, position.y);\n}\n\n// TODO: replace it with method in @antv/util\nfunction isPointInStroke(segments, lineWidth, px, py, length) {\n  var isHit = false;\n  var halfWidth = lineWidth / 2;\n  for (var i = 0; i < segments.length; i++) {\n    var segment = segments[i];\n    var currentPoint = segment.currentPoint,\n      params = segment.params,\n      prePoint = segment.prePoint,\n      box = segment.box;\n    // 如果在前面已经生成过包围盒，直接按照包围盒计算\n    if (box && !inBox(box.x - halfWidth, box.y - halfWidth, box.width + lineWidth, box.height + lineWidth, px, py)) {\n      continue;\n    }\n    switch (segment.command) {\n      // L 和 Z 都是直线， M 不进行拾取\n      case 'L':\n      case 'Z':\n        isHit = inLine(prePoint[0], prePoint[1], currentPoint[0], currentPoint[1], lineWidth, px, py);\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'Q':\n        var qDistance = quadPointDistance(prePoint[0], prePoint[1], params[1], params[2], params[3], params[4], px, py);\n        isHit = qDistance <= lineWidth / 2;\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'C':\n        var cDistance = cubicPointDistance(prePoint[0],\n        // 上一段结束位置, 即 C 的起始点\n        prePoint[1], params[1],\n        // 'C' 的参数，1、2 为第一个控制点，3、4 为第二个控制点，5、6 为结束点\n        params[2], params[3], params[4], params[5], params[6], px, py, length);\n        isHit = cDistance <= lineWidth / 2;\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'A':\n        // cache conversion result\n        if (!segment.cubicParams) {\n          segment.cubicParams = arcToCubic(prePoint[0], prePoint[1], params[1], params[2], params[3], params[4], params[5], params[6], params[7], undefined);\n        }\n        var args = segment.cubicParams;\n        // fixArc\n        var prePointInCubic = prePoint;\n        for (var i_1 = 0; i_1 < args.length; i_1 += 6) {\n          var cDistance_1 = cubicPointDistance(prePointInCubic[0],\n          // 上一段结束位置, 即 C 的起始点\n          prePointInCubic[1], args[i_1], args[i_1 + 1], args[i_1 + 2], args[i_1 + 3], args[i_1 + 4], args[i_1 + 5], px, py, length);\n          prePointInCubic = [args[i_1 + 4], args[i_1 + 5]];\n          isHit = cDistance_1 <= lineWidth / 2;\n          if (isHit) {\n            return true;\n          }\n        }\n        break;\n    }\n  }\n  return isHit;\n}\nfunction isPointInPath$4(displayObject, position, isClipPath, isPointInPath, renderingPluginContext, runtime) {\n  var _a = displayObject.parsedStyle,\n    _b = _a.lineWidth,\n    lineWidth = _b === void 0 ? 1 : _b,\n    _c = _a.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _c === void 0 ? 0 : _c,\n    stroke = _a.stroke,\n    fill = _a.fill,\n    d = _a.d,\n    _d = _a.pointerEvents,\n    pointerEvents = _d === void 0 ? 'auto' : _d;\n  var segments = d.segments,\n    hasArc = d.hasArc,\n    polylines = d.polylines,\n    polygons = d.polygons;\n  var _e = __read(isFillOrStrokeAffected(pointerEvents,\n    // Only a closed path can be filled.\n    (polygons === null || polygons === void 0 ? void 0 : polygons.length) && fill, stroke), 2),\n    hasFill = _e[0],\n    hasStroke = _e[1];\n  var totalLength = getOrCalculatePathTotalLength(displayObject);\n  var isHit = false;\n  if (hasFill || isClipPath) {\n    if (hasArc) {\n      // 存在曲线时，暂时使用 canvas 的 api 计算，后续可以进行多边形切割\n      isHit = isPointInPath(displayObject, position);\n    } else {\n      // 提取出来的多边形包含闭合的和非闭合的，在这里统一按照多边形处理\n      isHit = inPolygons(polygons, position.x, position.y) || inPolygons(polylines, position.x, position.y);\n    }\n    return isHit;\n  } else if (hasStroke || isClipPath) {\n    isHit = isPointInStroke(segments, lineWidth + increasedLineWidthForHitTesting, position.x, position.y, totalLength);\n  }\n  return isHit;\n}\nfunction isPointInPath$3(displayObject, position, isClipPath) {\n  var _a = displayObject.parsedStyle,\n    stroke = _a.stroke,\n    fill = _a.fill,\n    _b = _a.lineWidth,\n    lineWidth = _b === void 0 ? 1 : _b,\n    _c = _a.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _c === void 0 ? 0 : _c,\n    points = _a.points,\n    _d = _a.pointerEvents,\n    pointerEvents = _d === void 0 ? 'auto' : _d;\n  var _e = __read(isFillOrStrokeAffected(pointerEvents, fill, stroke), 2),\n    hasFill = _e[0],\n    hasStroke = _e[1];\n  var isHit = false;\n  if (hasStroke || isClipPath) {\n    isHit = inPolyline(points.points, lineWidth + increasedLineWidthForHitTesting, position.x, position.y, true);\n  }\n  if (!isHit && (hasFill || isClipPath)) {\n    isHit = inPolygon(points.points, position.x, position.y);\n  }\n  return isHit;\n}\nfunction isPointInPath$2(displayObject, position, isClipPath) {\n  var _a = displayObject.parsedStyle,\n    _b = _a.lineWidth,\n    lineWidth = _b === void 0 ? 1 : _b,\n    _c = _a.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _c === void 0 ? 0 : _c,\n    points = _a.points,\n    _d = _a.pointerEvents,\n    pointerEvents = _d === void 0 ? 'auto' : _d,\n    fill = _a.fill,\n    stroke = _a.stroke;\n  var _e = __read(isFillOrStrokeAffected(pointerEvents, fill, stroke), 2),\n    hasStroke = _e[1];\n  if (!hasStroke && !isClipPath || !lineWidth) {\n    return false;\n  }\n  return inPolyline(points.points, lineWidth + increasedLineWidthForHitTesting, position.x, position.y, false);\n}\nfunction isPointInPath$1(displayObject, position, isClipPath, isPointInPath, runtime) {\n  var _a = displayObject.parsedStyle,\n    radius = _a.radius,\n    fill = _a.fill,\n    stroke = _a.stroke,\n    _b = _a.lineWidth,\n    lineWidth = _b === void 0 ? 1 : _b,\n    _c = _a.increasedLineWidthForHitTesting,\n    increasedLineWidthForHitTesting = _c === void 0 ? 0 : _c,\n    _d = _a.x,\n    x = _d === void 0 ? 0 : _d,\n    _e = _a.y,\n    y = _e === void 0 ? 0 : _e,\n    width = _a.width,\n    height = _a.height,\n    _f = _a.pointerEvents,\n    pointerEvents = _f === void 0 ? 'auto' : _f;\n  var _g = __read(isFillOrStrokeAffected(pointerEvents, fill, stroke), 2),\n    hasFill = _g[0],\n    hasStroke = _g[1];\n  var hasRadius = radius && radius.some(function (r) {\n    return r !== 0;\n  });\n  var lineWidthForHitTesting = lineWidth + increasedLineWidthForHitTesting;\n  // 无圆角时的策略\n  if (!hasRadius) {\n    var halfWidth = lineWidthForHitTesting / 2;\n    // 同时填充和带有边框\n    if (hasFill && hasStroke || isClipPath) {\n      return inBox(x - halfWidth, y - halfWidth, width + halfWidth, height + halfWidth, position.x, position.y);\n    }\n    // 仅填充\n    if (hasFill) {\n      return inBox(x, y, width, height, position.x, position.y);\n    }\n    if (hasStroke) {\n      return inRect(x, y, width, height, lineWidthForHitTesting, position.x, position.y);\n    }\n  } else {\n    var isHit = false;\n    if (hasStroke || isClipPath) {\n      isHit = inRectWithRadius(x, y, width, height, radius.map(function (r) {\n        return clamp(r, 0, Math.min(Math.abs(width) / 2, Math.abs(height) / 2));\n      }), lineWidthForHitTesting, position.x, position.y);\n    }\n    // 仅填充时带有圆角的矩形直接通过图形拾取\n    // 以后可以改成纯数学的近似拾取，将圆弧切割成多边形\n    if (!isHit && (hasFill || isClipPath)) {\n      isHit = isPointInPath(displayObject, position);\n    }\n    return isHit;\n  }\n  return false;\n}\nfunction inRectWithRadius(minX, minY, width, height, radiusArray, lineWidth, x, y) {\n  var _a = __read(radiusArray, 4),\n    tlr = _a[0],\n    trr = _a[1],\n    brr = _a[2],\n    blr = _a[3];\n  return inLine(minX + tlr, minY, minX + width - trr, minY, lineWidth, x, y) || inLine(minX + width, minY + trr, minX + width, minY + height - brr, lineWidth, x, y) || inLine(minX + width - brr, minY + height, minX + blr, minY + height, lineWidth, x, y) || inLine(minX, minY + height - blr, minX, minY + tlr, lineWidth, x, y) || inArc(minX + width - trr, minY + trr, trr, 1.5 * Math.PI, 2 * Math.PI, lineWidth, x, y) || inArc(minX + width - brr, minY + height - brr, brr, 0, 0.5 * Math.PI, lineWidth, x, y) || inArc(minX + blr, minY + height - blr, blr, 0.5 * Math.PI, Math.PI, lineWidth, x, y) || inArc(minX + tlr, minY + tlr, tlr, Math.PI, 1.5 * Math.PI, lineWidth, x, y);\n}\nfunction isPointInPath(displayObject, position, isClipPath, isPointInPath, renderingPluginContext, runtime) {\n  var _a = displayObject.parsedStyle,\n    _b = _a.pointerEvents,\n    pointerEvents = _b === void 0 ? 'auto' : _b,\n    _c = _a.x,\n    x = _c === void 0 ? 0 : _c,\n    _d = _a.y,\n    y = _d === void 0 ? 0 : _d,\n    width = _a.width,\n    height = _a.height;\n  if (pointerEvents === 'non-transparent-pixel') {\n    var offscreenCanvas = renderingPluginContext.config.offscreenCanvas;\n    var canvas = runtime.offscreenCanvasCreator.getOrCreateCanvas(offscreenCanvas);\n    var context = runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas, {\n      willReadFrequently: true\n    });\n    canvas.width = width;\n    canvas.height = height;\n    renderingPluginContext.defaultStyleRendererFactory[Shape.IMAGE].render(context, __assign(__assign({}, displayObject.parsedStyle), {\n      x: 0,\n      y: 0\n    }), displayObject, undefined, undefined, undefined);\n    var imagedata = context.getImageData(position.x - x, position.y - y, 1, 1).data;\n    return imagedata.every(function (component) {\n      return component !== 0;\n    });\n  }\n  return true;\n}\nvar Plugin = /** @class */function (_super) {\n  __extends(Plugin, _super);\n  function Plugin() {\n    var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n    _this.name = 'canvas-picker';\n    return _this;\n  }\n  Plugin.prototype.init = function () {\n    var _a;\n    var trueFunc = function () {\n      return true;\n    };\n    var pointInPathPickerFactory = (_a = {}, _a[Shape.CIRCLE] = isPointInPath$7, _a[Shape.ELLIPSE] = isPointInPath$6, _a[Shape.RECT] = isPointInPath$1, _a[Shape.LINE] = isPointInPath$5, _a[Shape.POLYLINE] = isPointInPath$2, _a[Shape.POLYGON] = isPointInPath$3, _a[Shape.PATH] = isPointInPath$4, _a[Shape.TEXT] = trueFunc, _a[Shape.GROUP] = null, _a[Shape.IMAGE] = isPointInPath, _a[Shape.HTML] = null, _a[Shape.MESH] = null, _a);\n    // @ts-ignore\n    this.context.pointInPathPickerFactory = pointInPathPickerFactory;\n    this.addRenderingPlugin(new CanvasPickerPlugin());\n  };\n  Plugin.prototype.destroy = function () {\n    // @ts-ignore\n    delete this.context.pointInPathPickerFactory;\n    this.removeAllRenderingPlugins();\n  };\n  return Plugin;\n}(AbstractRendererPlugin);\nexport { Plugin };","map":{"version":3,"names":["tmpVec3a","vec3","create","tmpVec3b","tmpVec3c","tmpMat4","mat4","CanvasPickerPlugin","_this","isHit","displayObject","position","worldTransform","isClipPath","pick","context","pointInPathPickerFactory","nodeName","invertWorldMat","invert","localPosition","transformMat4","set","Point","isPointInPath","runtime","offscreenCanvasCreator","getOrCreateContext","config","offscreenCanvas","generatePath","pathGeneratorFactory","beginPath","parsedStyle","closePath","x","y","prototype","apply","renderingService","renderingContext","document","_a","root","ownerDocument","hooks","tapPromise","tag","result","__awaiter","pickSync","tap","topmost","_b","hitTestList","elementsFromBBox","pickedDisplayObjects","hitTestList_1","__values","hitTestList_1_1","next","done","value","getWorldTransform","isHitOriginShape","clipped","findClosestClipPathTarget","clipPath","isHitClipPath","picked","push","isPointInPath$7","cx","_c","cy","r","fill","stroke","_d","lineWidth","_e","increasedLineWidthForHitTesting","_f","pointerEvents","halfLineWidth","absDistance","distance","_g","__read","isFillOrStrokeAffected","hasFill","hasStroke","ellipseDistance","squareX","squareY","rx","ry","isPointInPath$6","halfLineWith","inBox","minX","minY","width","height","inRect","halfWidth","inArc","startAngle","endAngle","angle","Math","atan2","PI","point","cos","sin","inLine","x1","y1","x2","y2","min","maxX","max","maxY","linePointToLine","inPolyline","points","isClose","count","length","i","first","last","tolerance","dcmp","abs","onSegment","p1","p2","q","inPolygon","n","inPolygons","polygons","isPointInPath$5","isPointInStroke","segments","px","py","segment","currentPoint","params","prePoint","box","command","qDistance","quadPointDistance","cDistance","cubicPointDistance","cubicParams","arcToCubic","undefined","args","prePointInCubic","i_1","cDistance_1","isPointInPath$4","renderingPluginContext","d","hasArc","polylines","totalLength","getOrCalculatePathTotalLength","isPointInPath$3","isPointInPath$2","isPointInPath$1","radius","hasRadius","some","lineWidthForHitTesting","inRectWithRadius","map","clamp","radiusArray","tlr","trr","brr","blr","canvas","getOrCreateCanvas","willReadFrequently","defaultStyleRendererFactory","Shape","IMAGE","render","__assign","imagedata","getImageData","data","every","component","Plugin","_super","__extends","name","init","trueFunc","CIRCLE","ELLIPSE","RECT","LINE","POLYLINE","POLYGON","PATH","TEXT","GROUP","HTML","MESH","addRenderingPlugin","destroy","removeAllRenderingPlugins","AbstractRendererPlugin"],"sources":["../src/packages/g-plugin-canvas-picker/src/CanvasPickerPlugin.ts","../src/packages/g-plugin-canvas-picker/src/Circle.ts","../src/packages/g-plugin-canvas-picker/src/Ellipse.ts","../src/packages/g-plugin-canvas-picker/src/utils/math.ts","../src/packages/g-plugin-canvas-picker/src/Line.ts","../src/packages/g-plugin-canvas-picker/src/Path.ts","../src/packages/g-plugin-canvas-picker/src/Polygon.ts","../src/packages/g-plugin-canvas-picker/src/Polyline.ts","../src/packages/g-plugin-canvas-picker/src/Rect.ts","../src/packages/g-plugin-canvas-picker/src/Image.ts","../src/packages/g-plugin-canvas-picker/src/index.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}