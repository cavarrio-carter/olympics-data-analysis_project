{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { Rect } from '@antv/g';\nimport { deepMix, upperFirst, isArray } from '@antv/util';\nimport { group, groups } from 'd3-array';\nimport { format } from 'd3-format';\nimport { mapObject } from '../utils/array';\nimport { ChartEvent } from '../utils/event';\nimport { isStrictObject, appendTransform, compose, copyAttributes, defined, error, maybeSubObject, subObject, useMemo } from '../utils/helper';\nimport { select, Selection } from '../utils/selection';\nimport { groupComponents, inferComponent, normalizeComponents, renderComponent } from './component';\nimport { AREA_CLASS_NAME, COMPONENT_CLASS_NAME, ELEMENT_CLASS_NAME, LABEL_CLASS_NAME, LABEL_LAYER_CLASS_NAME, MAIN_LAYER_CLASS_NAME, PLOT_CLASS_NAME, VIEW_CLASS_NAME } from './constant';\nimport { coordinate2Transform, createCoordinate } from './coordinate';\nimport { computeLayout, computeRoughPlotSize, placeComponents, processAxisZ } from './layout';\nimport { documentOf, useLibrary } from './library';\nimport { initializeMark } from './mark';\nimport { applyScale, assignScale, collectScales, inferScale, syncFacetsScales, useRelationScale, groupTransform } from './scale';\nimport { applyDataTransform } from './transform';\nexport function plot(options, selection, context) {\n  var _a;\n  return __awaiter(this, void 0, void 0, function* () {\n    const {\n      library\n    } = context;\n    const [useComposition] = useLibrary('composition', library);\n    const [useInteraction] = useLibrary('interaction', library);\n    // Some helper functions.\n    const marks = new Set(Object.keys(library).map(d => {\n      var _a;\n      return (_a = /mark\\.(.*)/.exec(d)) === null || _a === void 0 ? void 0 : _a[1];\n    }).filter(defined));\n    const staticMarks = new Set(Object.keys(library).map(d => {\n      var _a;\n      return (_a = /component\\.(.*)/.exec(d)) === null || _a === void 0 ? void 0 : _a[1];\n    }).filter(defined));\n    const typeOf = node => {\n      const {\n        type\n      } = node;\n      if (typeof type === 'function') {\n        // @ts-ignore\n        const {\n          props = {}\n        } = type;\n        const {\n          composite = true\n        } = props;\n        if (composite) return 'mark';\n      }\n      if (typeof type !== 'string') return type;\n      if (marks.has(type) || staticMarks.has(type)) return 'mark';\n      return type;\n    };\n    const isMark = node => typeOf(node) === 'mark';\n    const isStandardView = node => typeOf(node) === 'standardView';\n    const isStaticMark = node => {\n      const {\n        type\n      } = node;\n      if (typeof type !== 'string') return false;\n      if (staticMarks.has(type)) return true;\n      return false;\n    };\n    const transform = node => {\n      if (isStandardView(node)) return [node];\n      const type = typeOf(node);\n      const composition = useComposition({\n        type,\n        static: isStaticMark(node)\n      });\n      return composition(node);\n    };\n    // Some temporary variables help parse the view tree.\n    const views = [];\n    const viewNode = new Map();\n    const nodeState = new Map();\n    const discovered = [options];\n    const nodeGenerators = [];\n    while (discovered.length) {\n      const node = discovered.shift();\n      if (isStandardView(node)) {\n        // Initialize view to get data to be visualized. If the marks\n        // of the view have already been initialized (facet view),\n        // initialize the view based on the initialized mark states,\n        // otherwise initialize it from beginning.\n        const state = nodeState.get(node);\n        const [view, children] = state ? initializeState(state, node, library) : yield initializeView(node, context);\n        viewNode.set(view, node);\n        views.push(view);\n        // Transform children, they will be transformed into\n        // standardView if they are mark or view node.\n        const transformedNodes = children.flatMap(transform).map(d => coordinate2Transform(d, library));\n        discovered.push(...transformedNodes);\n        // Only StandardView can be treated as facet and it\n        // should sync position scales among facets normally.\n        if (transformedNodes.every(isStandardView)) {\n          const states = yield Promise.all(transformedNodes.map(d => initializeMarks(d, context)));\n          // Note!!!\n          // This will mutate scales for marks.\n          syncFacetsScales(states);\n          for (let i = 0; i < transformedNodes.length; i++) {\n            const nodeT = transformedNodes[i];\n            const state = states[i];\n            nodeState.set(nodeT, state);\n          }\n        }\n      } else {\n        // Apply transform to get data in advance for non-mark composition\n        // node, which makes sure that composition node can preprocess the\n        // data to produce more nodes based on it.\n        const n = isMark(node) ? node : yield applyTransform(node, context);\n        const N = transform(n);\n        if (Array.isArray(N)) discovered.push(...N);else if (typeof N === 'function') nodeGenerators.push(N());\n      }\n    }\n    context.emitter.emit(ChartEvent.BEFORE_PAINT);\n    // Plot chart.\n    const enterContainer = new Map();\n    const updateContainer = new Map();\n    const transitions = [];\n    selection.selectAll(className(VIEW_CLASS_NAME)).data(views, d => d.key).join(enter => enter.append('g').attr('className', VIEW_CLASS_NAME).attr('id', view => view.key).call(applyTranslate).each(function (view, i, element) {\n      plotView(view, select(element), transitions, context);\n      enterContainer.set(view, element);\n    }), update => update.call(applyTranslate).each(function (view, i, element) {\n      plotView(view, select(element), transitions, context);\n      updateContainer.set(view, element);\n    }), exit => exit.each(function (d, i, element) {\n      // Remove existed interactions.\n      const interactions = element['nameInteraction'].values();\n      for (const interaction of interactions) {\n        interaction.destroy();\n      }\n    }).remove());\n    // Apply interactions.\n    const viewInstanceof = (viewContainer, updateInteractions, oldStore) => {\n      return Array.from(viewContainer.entries()).map(([view, container]) => {\n        // Index state by component or interaction name,\n        // such as legend, scrollbar, brushFilter.\n        // Each state transform options to another options.\n        const store = oldStore || new Map();\n        const setState = (key, reducer = x => x) => store.set(key, reducer);\n        const options = viewNode.get(view);\n        const update = createUpdateView(select(container), options, context);\n        return {\n          view,\n          container,\n          options,\n          setState,\n          update: (from, updateTypes) => __awaiter(this, void 0, void 0, function* () {\n            // Apply all state functions to get new options.\n            const reducer = compose(Array.from(store.values()));\n            const newOptions = reducer(options);\n            return yield update(newOptions, from, () => {\n              if (isArray(updateTypes)) {\n                updateInteractions(viewContainer, updateTypes, store);\n              }\n            });\n          })\n        };\n      });\n    };\n    const updateInteractions = (container = updateContainer, updateType, oldStore) => {\n      var _a;\n      // Interactions for update views.\n      const updateViewInstances = viewInstanceof(container, updateInteractions, oldStore);\n      for (const target of updateViewInstances) {\n        const {\n          options,\n          container\n        } = target;\n        const nameInteraction = container['nameInteraction'];\n        let typeOptions = inferInteraction(options);\n        if (updateType) {\n          typeOptions = typeOptions.filter(v => updateType.includes(v[0]));\n        }\n        for (const typeOption of typeOptions) {\n          const [type, option] = typeOption;\n          // Remove interaction for existed views.\n          const prevInteraction = nameInteraction.get(type);\n          if (prevInteraction) (_a = prevInteraction.destroy) === null || _a === void 0 ? void 0 : _a.call(prevInteraction);\n          // Apply new interaction.\n          if (option) {\n            const interaction = useThemeInteraction(target.view, type, option, useInteraction);\n            const destroy = interaction(target, updateViewInstances, context.emitter);\n            nameInteraction.set(type, {\n              destroy\n            });\n          }\n        }\n      }\n    };\n    // Interactions for enter views.\n    const enterViewInstances = viewInstanceof(enterContainer, updateInteractions);\n    for (const target of enterViewInstances) {\n      const {\n        options\n      } = target;\n      // A Map index interaction by interaction name.\n      const nameInteraction = new Map();\n      target.container['nameInteraction'] = nameInteraction;\n      // Apply interactions.\n      for (const typeOption of inferInteraction(options)) {\n        const [type, option] = typeOption;\n        if (option) {\n          const interaction = useThemeInteraction(target.view, type, option, useInteraction);\n          const destroy = interaction(target, enterViewInstances, context.emitter);\n          nameInteraction.set(type, {\n            destroy\n          });\n        }\n      }\n    }\n    updateInteractions();\n    // Author animations.\n    const {\n      width,\n      height\n    } = options;\n    const keyframes = [];\n    for (const nodeGenerator of nodeGenerators) {\n      // Delay the rendering of animation keyframe. Different animation\n      // created by different nodeGenerator will play in the same time.\n      // eslint-disable-next-line no-async-promise-executor\n      const keyframe = new Promise(resolve => __awaiter(this, void 0, void 0, function* () {\n        for (const node of nodeGenerator) {\n          const sizedNode = Object.assign({\n            width,\n            height\n          }, node);\n          yield plot(sizedNode, selection, context);\n        }\n        resolve();\n      }));\n      keyframes.push(keyframe);\n    }\n    context.views = views;\n    // Clear and update animation.\n    (_a = context.animations) === null || _a === void 0 ? void 0 : _a.forEach(animation => animation === null || animation === void 0 ? void 0 : animation.cancel());\n    context.animations = transitions;\n    context.emitter.emit(ChartEvent.AFTER_PAINT);\n    // Note!!!\n    // The returned promise will never resolved if one of nodeGenerator\n    // never stop to yield node, which may created by a keyframe composition\n    // with iteration count set to infinite.\n    const finished = transitions.filter(defined).map(cancel).map(d => d.finished);\n    return Promise.all([...finished, ...keyframes]);\n  });\n}\nfunction applyTranslate(selection) {\n  selection.style('transform', d => `translate(${d.layout.x}, ${d.layout.y})`);\n}\nfunction definedInteraction(library) {\n  const [, createInteraction] = useLibrary('interaction', library);\n  return d => {\n    const [name, options] = d;\n    try {\n      return [name, createInteraction(name)];\n    } catch (_a) {\n      return [name, options.type];\n    }\n  };\n}\nfunction createUpdateView(selection, options, context) {\n  const {\n    library\n  } = context;\n  const createDefinedInteraction = definedInteraction(library);\n  const filter = d => d[1] && d[1].props && d[1].props.reapplyWhenUpdate;\n  const interactions = inferInteraction(options);\n  const updates = interactions.map(createDefinedInteraction).filter(filter).map(d => d[0]);\n  return (newOptions, source, callback) => __awaiter(this, void 0, void 0, function* () {\n    const transitions = [];\n    const [newView, newChildren] = yield initializeView(newOptions, context);\n    plotView(newView, selection, transitions, context);\n    // Update interaction need to reapply when update.\n    for (const name of updates.filter(d => d !== source)) {\n      updateInteraction(name, selection, newOptions, newView, context);\n    }\n    for (const child of newChildren) {\n      plot(child, selection, context);\n    }\n    callback();\n    return {\n      options: newOptions,\n      view: newView\n    };\n  });\n}\nfunction updateInteraction(name, selection, options, view, context) {\n  var _a;\n  const {\n    library\n  } = context;\n  const [useInteraction] = useLibrary('interaction', library);\n  // Instances for interaction.\n  const container = selection.node();\n  const nameInteraction = container['nameInteraction'];\n  const interactionOptions = inferInteraction(options).find(([d]) => d === name);\n  // Destroy older interaction.\n  const interaction = nameInteraction.get(name);\n  if (!interaction) return;\n  (_a = interaction.destroy) === null || _a === void 0 ? void 0 : _a.call(interaction);\n  if (!interactionOptions[1]) return;\n  // Apply new interaction.\n  const applyInteraction = useThemeInteraction(view, name, interactionOptions[1], useInteraction);\n  const target = {\n    options,\n    view,\n    container: selection.node(),\n    update: options => Promise.resolve(options)\n  };\n  const destroy = applyInteraction(target, [], context.emitter);\n  nameInteraction.set(name, {\n    destroy\n  });\n}\nfunction initializeView(options, context) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const {\n      library\n    } = context;\n    const flattenOptions = yield transformMarks(options, context);\n    const mergedOptions = bubbleOptions(flattenOptions);\n    // @todo Remove this.\n    // !!! NOTE: Mute original view options.\n    // Update interaction and coordinate for this view.\n    options.interaction = mergedOptions.interaction;\n    options.coordinate = mergedOptions.coordinate;\n    // @ts-ignore\n    options.marks = [...mergedOptions.marks, ...mergedOptions.components];\n    const transformedOptions = coordinate2Transform(mergedOptions, library);\n    const state = yield initializeMarks(transformedOptions, context);\n    return initializeState(state, transformedOptions, library);\n  });\n}\nfunction bubbleOptions(options) {\n  const {\n      coordinate: viewCoordinate = {},\n      interaction: viewInteraction = {},\n      style: viewStyle = {},\n      marks\n    } = options,\n    rest = __rest(options, [\"coordinate\", \"interaction\", \"style\", \"marks\"]);\n  const markCoordinates = marks.map(d => d.coordinate || {});\n  const markInteractions = marks.map(d => d.interaction || {});\n  const markViewStyles = marks.map(d => d.viewStyle || {});\n  const newCoordinate = [...markCoordinates, viewCoordinate].reduceRight((prev, cur) => deepMix(prev, cur), {});\n  const newInteraction = [viewInteraction, ...markInteractions].reduce((prev, cur) => deepMix(prev, cur), {});\n  const newStyle = [...markViewStyles, viewStyle].reduce((prev, cur) => deepMix(prev, cur), {});\n  return Object.assign(Object.assign({}, rest), {\n    marks,\n    coordinate: newCoordinate,\n    interaction: newInteraction,\n    style: newStyle\n  });\n}\nfunction transformMarks(options, context) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const {\n      library\n    } = context;\n    const [useMark, createMark] = useLibrary('mark', library);\n    const staticMarks = new Set(Object.keys(library).map(d => {\n      var _a;\n      return (_a = /component\\.(.*)/.exec(d)) === null || _a === void 0 ? void 0 : _a[1];\n    }).filter(defined));\n    const {\n      marks\n    } = options;\n    const flattenMarks = [];\n    const components = [];\n    const discovered = [...marks];\n    const {\n      width,\n      height\n    } = computeRoughPlotSize(options);\n    const markOptions = {\n      options,\n      width,\n      height\n    };\n    // Pre order traversal.\n    while (discovered.length) {\n      const [node] = discovered.splice(0, 1);\n      // Apply data transform to get data.\n      const mark = yield applyTransform(node, context);\n      const {\n        type = error('G2Mark type is required.'),\n        key\n      } = mark;\n      // For components.\n      if (staticMarks.has(type)) components.push(mark);else {\n        const {\n          props = {}\n        } = createMark(type);\n        const {\n          composite = true\n        } = props;\n        if (!composite) flattenMarks.push(mark);else {\n          // Unwrap data from { value: data } to data,\n          // then the composite mark can process the normalized data.\n          const {\n            data\n          } = mark;\n          const newMark = Object.assign(Object.assign({}, mark), {\n            data: data ? Array.isArray(data) ? data : data.value : data\n          });\n          // Convert composite mark to marks.\n          const marks = yield useMark(newMark, markOptions);\n          const M = Array.isArray(marks) ? marks : [marks];\n          discovered.unshift(...M.map((d, i) => Object.assign(Object.assign({}, d), {\n            key: `${key}-${i}`\n          })));\n        }\n      }\n    }\n    return Object.assign(Object.assign({}, options), {\n      marks: flattenMarks,\n      components\n    });\n  });\n}\nfunction initializeMarks(options, context) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const {\n      library\n    } = context;\n    const [useTheme] = useLibrary('theme', library);\n    const [, createMark] = useLibrary('mark', library);\n    const {\n      theme: partialTheme,\n      marks: partialMarks,\n      coordinates = []\n    } = options;\n    const theme = useTheme(inferTheme(partialTheme));\n    const markState = new Map();\n    // Initialize channels for marks.\n    for (const markOptions of partialMarks) {\n      const {\n        type\n      } = markOptions;\n      const {\n        props = {}\n      } = createMark(type);\n      const markAndState = yield initializeMark(markOptions, props, context);\n      if (markAndState) {\n        const [initializedMark, state] = markAndState;\n        markState.set(initializedMark, state);\n      }\n    }\n    // Group channels by scale key, each group has scale.\n    const scaleChannels = group(Array.from(markState.values()).flatMap(d => d.channels), ({\n      scaleKey\n    }) => scaleKey);\n    // Infer scale for each channel groups.\n    for (const channels of scaleChannels.values()) {\n      // Merge scale options for these channels.\n      const scaleOptions = channels.reduce((total, {\n        scale\n      }) => deepMix(total, scale), {});\n      const {\n        scaleKey\n      } = channels[0];\n      // Use the fields of the first channel as the title.\n      const {\n        values: FV\n      } = channels[0];\n      const fields = Array.from(new Set(FV.map(d => d.field).filter(defined)));\n      const options = deepMix({\n        guide: {\n          title: fields.length === 0 ? undefined : fields\n        },\n        field: fields[0]\n      }, scaleOptions);\n      // Use the name of the first channel as the scale name.\n      const {\n        name\n      } = channels[0];\n      const values = channels.flatMap(({\n        values\n      }) => values.map(d => d.value));\n      const scale = Object.assign(Object.assign({}, inferScale(name, values, options, coordinates, theme, library)), {\n        uid: Symbol('scale'),\n        key: scaleKey\n      });\n      channels.forEach(channel => channel.scale = scale);\n    }\n    return markState;\n  });\n}\nfunction useThemeInteraction(view, type, option, useInteraction) {\n  const theme = view.theme;\n  const defaults = typeof type === 'string' ? theme[type] || {} : {};\n  const interaction = useInteraction(deepMix(defaults, Object.assign({\n    type\n  }, option)));\n  return interaction;\n}\nfunction initializeState(markState, options, library) {\n  var _a;\n  const [useMark] = useLibrary('mark', library);\n  const [useTheme] = useLibrary('theme', library);\n  const [useLabelTransform] = useLibrary('labelTransform', library);\n  const {\n    key,\n    frame = false,\n    theme: partialTheme,\n    clip,\n    style = {},\n    labelTransform = []\n  } = options;\n  const theme = useTheme(inferTheme(partialTheme));\n  // Infer components and compute layout.\n  const states = Array.from(markState.values());\n  const scales = collectScales(states, options);\n  const components = normalizeComponents(inferComponent(inferComponentScales(Array.from(scales), states, markState), options, library));\n  const layout = computeLayout(components, options, theme, library);\n  const coordinate = createCoordinate(layout, options, library);\n  const framedStyle = frame ? deepMix({\n    mainLineWidth: 1,\n    mainStroke: '#000'\n  }, style) : style;\n  // Place components and mutate their bbox.\n  placeComponents(groupComponents(components), coordinate, layout);\n  // AxisZ need a copy of axisX and axisY to show grids in X-Z & Y-Z planes.\n  processAxisZ(components);\n  // Index scale instance by uid.\n  const uidScale = new Map(Array.from(markState.values()).flatMap(state => {\n    const {\n      channels\n    } = state;\n    return channels.map(({\n      scale\n    }) => [scale.uid, useRelationScale(scale, library)]);\n  }));\n  groupTransform(markState, uidScale);\n  // Scale from marks and components.\n  const scaleInstance = {};\n  // Initialize scale from components.\n  for (const component of components) {\n    const {\n      scales: scaleDescriptors = []\n    } = component;\n    const scales = [];\n    for (const descriptor of scaleDescriptors) {\n      const {\n        name,\n        uid\n      } = descriptor;\n      const scale = (_a = uidScale.get(uid)) !== null && _a !== void 0 ? _a : useRelationScale(descriptor, library);\n      scales.push(scale);\n      // Delivery the scale of axisX to the AxisY,\n      // in order to calculate the angle of axisY component when rendering radar chart.\n      if (name === 'y') {\n        scale.update(Object.assign(Object.assign({}, scale.getOptions()), {\n          xScale: scaleInstance.x\n        }));\n      }\n      assignScale(scaleInstance, {\n        [name]: scale\n      });\n    }\n    component.scaleInstances = scales;\n  }\n  // Calc data to be rendered for each mark.\n  // @todo More readable APIs for Container which stays\n  // the same style with JS standard and lodash APIs.\n  // @todo More proper way to index scale for different marks.\n  const children = [];\n  for (const [mark, state] of markState.entries()) {\n    const {\n      // scale,\n      // Callback to create children options based on this mark.\n      children: createChildren,\n      // The total count of data (both show and hide)for this facet.\n      // This is for unit visualization to sync data domain.\n      dataDomain,\n      modifier,\n      key: markKey\n    } = mark;\n    const {\n      index,\n      channels,\n      tooltip\n    } = state;\n    const scale = Object.fromEntries(channels.map(({\n      name,\n      scale\n    }) => [name, scale]));\n    // Transform abstract value to visual value by scales.\n    const markScaleInstance = mapObject(scale, ({\n      uid\n    }) => uidScale.get(uid));\n    assignScale(scaleInstance, markScaleInstance);\n    const value = applyScale(channels, markScaleInstance);\n    // Calc points and transformation for each data,\n    // and then transform visual value to visual data.\n    const calcPoints = useMark(mark);\n    const [I, P, S] = filterValid(calcPoints(index, markScaleInstance, value, coordinate));\n    const count = dataDomain || I.length;\n    const T = modifier ? modifier(P, count, layout) : [];\n    const titleOf = i => {\n      var _a, _b;\n      return (_b = (_a = tooltip.title) === null || _a === void 0 ? void 0 : _a[i]) === null || _b === void 0 ? void 0 : _b.value;\n    };\n    const itemsOf = i => tooltip.items.map(V => V[i]);\n    const visualData = I.map((d, i) => {\n      const datum = Object.assign({\n        points: P[i],\n        transform: T[i],\n        index: d,\n        markKey,\n        viewKey: key\n      }, tooltip && {\n        title: titleOf(d),\n        items: itemsOf(d)\n      });\n      for (const [k, V] of Object.entries(value)) {\n        datum[k] = V[d];\n        if (S) datum[`series${upperFirst(k)}`] = S[i].map(i => V[i]);\n      }\n      if (S) datum['seriesIndex'] = S[i];\n      if (S && tooltip) {\n        datum['seriesItems'] = S[i].map(si => itemsOf(si));\n        datum['seriesTitle'] = S[i].map(si => titleOf(si));\n      }\n      return datum;\n    });\n    state.data = visualData;\n    state.index = I;\n    // Create children options by children callback,\n    // and then propagate data to each child.\n    const markChildren = createChildren === null || createChildren === void 0 ? void 0 : createChildren(visualData, markScaleInstance, layout);\n    children.push(...(markChildren || []));\n  }\n  const view = {\n    layout,\n    theme,\n    coordinate,\n    markState,\n    key,\n    clip,\n    scale: scaleInstance,\n    style: framedStyle,\n    components,\n    labelTransform: compose(labelTransform.map(useLabelTransform))\n  };\n  return [view, children];\n}\nfunction plotView(view, selection, transitions, context) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const {\n      library\n    } = context;\n    const {\n      components,\n      theme,\n      layout,\n      markState,\n      coordinate,\n      key,\n      style,\n      clip,\n      scale\n    } = view;\n    // Render background for the different areas.\n    const {\n        x,\n        y,\n        width,\n        height\n      } = layout,\n      rest = __rest(layout, [\"x\", \"y\", \"width\", \"height\"]);\n    const areaKeys = ['view', 'plot', 'main', 'content'];\n    const I = areaKeys.map((_, i) => i);\n    const sizeKeys = ['a', 'margin', 'padding', 'inset'];\n    const areaStyles = areaKeys.map(d => maybeSubObject(Object.assign({}, theme.view, style), d));\n    const areaSizes = sizeKeys.map(d => subObject(rest, d));\n    const styleArea = selection => selection.style('x', i => areaLayouts[i].x).style('y', i => areaLayouts[i].y).style('width', i => areaLayouts[i].width).style('height', i => areaLayouts[i].height).each(function (i, d, element) {\n      applyStyle(select(element), areaStyles[i]);\n    });\n    let px = 0;\n    let py = 0;\n    let pw = width;\n    let ph = height;\n    const areaLayouts = I.map(i => {\n      const size = areaSizes[i];\n      const {\n        left = 0,\n        top = 0,\n        bottom = 0,\n        right = 0\n      } = size;\n      px += left;\n      py += top;\n      pw -= left + right;\n      ph -= top + bottom;\n      return {\n        x: px,\n        y: py,\n        width: pw,\n        height: ph\n      };\n    });\n    selection.selectAll(className(AREA_CLASS_NAME)).data(\n    // Only render area with defined style.\n    I.filter(i => defined(areaStyles[i])), i => areaKeys[i]).join(enter => enter.append('rect').attr('className', AREA_CLASS_NAME).style('zIndex', -2).call(styleArea), update => update.call(styleArea), exit => exit.remove());\n    const animationExtent = computeAnimationExtent(markState);\n    const componentAnimateOptions = animationExtent ? {\n      duration: animationExtent[1]\n    } : false;\n    // Render components.\n    // @todo renderComponent return ctor and options.\n    // Key for each type of component.\n    // Index them grouped by position.\n    for (const [, C] of groups(components, d => `${d.type}-${d.position}`)) {\n      C.forEach((d, i) => d.index = i);\n    }\n    const componentsTransitions = selection.selectAll(className(COMPONENT_CLASS_NAME)).data(components, d => `${d.type}-${d.position}-${d.index}`).join(enter => enter.append('g').style('zIndex', ({\n      zIndex\n    }) => zIndex || -1).attr('className', COMPONENT_CLASS_NAME).append(options => renderComponent(deepMix({\n      animate: componentAnimateOptions,\n      scale\n    }, options), coordinate, theme, library, markState)), update => update.transition(function (options, i, element) {\n      const {\n        preserve = false\n      } = options;\n      if (preserve) return;\n      const newComponent = renderComponent(deepMix({\n        animate: componentAnimateOptions,\n        scale\n      }, options), coordinate, theme, library, markState);\n      const {\n        attributes\n      } = newComponent;\n      const [node] = element.childNodes;\n      return node.update(attributes, false);\n    })).transitions();\n    transitions.push(...componentsTransitions.flat().filter(defined));\n    // Main layer is for showing the main visual representation such as marks. There\n    // may be multiple main layers for a view, each main layer correspond to one of marks.\n    // @todo Test DOM structure.\n    const T = selection.selectAll(className(PLOT_CLASS_NAME)).data([layout], () => key).join(enter => enter\n    // Make this layer interactive, such as click and mousemove events.\n    .append('rect').style('zIndex', 0).style('fill', 'transparent').attr('className', PLOT_CLASS_NAME).call(updateBBox).call(updateLayers, Array.from(markState.keys())).call(applyClip, clip), update => update.call(updateLayers, Array.from(markState.keys())).call(selection => {\n      return animationExtent ? animateBBox(selection, animationExtent) : updateBBox(selection);\n    }).call(applyClip, clip)).transitions();\n    transitions.push(...T.flat());\n    // Render marks with corresponding data.\n    for (const [mark, state] of markState.entries()) {\n      const {\n        data\n      } = state;\n      const {\n        key,\n        class: cls,\n        type\n      } = mark;\n      const viewNode = selection.select(`#${key}`);\n      const shapeFunction = createMarkShapeFunction(mark, state, view, context);\n      const enterFunction = createEnterFunction(mark, state, view, library);\n      const updateFunction = createUpdateFunction(mark, state, view, library);\n      const exitFunction = createExitFunction(mark, state, view, library);\n      const facetElements = selectFacetElements(selection, viewNode, cls, 'element');\n      const T = viewNode.selectAll(className(ELEMENT_CLASS_NAME)).selectFacetAll(facetElements).data(data, d => d.key, d => d.groupKey).join(enter => enter.append(shapeFunction)\n      // Note!!! Only one className can be set.\n      // Using attribute as alternative for other classNames.\n      .attr('className', ELEMENT_CLASS_NAME).attr('markType', type).transition(function (data, i, element) {\n        return enterFunction(data, [element]);\n      }), update => update.call(selection => {\n        const parent = selection.parent();\n        const origin = useMemo(node => {\n          const [x, y] = node.getBounds().min;\n          return [x, y];\n        });\n        selection.transition(function (data, index, element) {\n          maybeFacetElement(element, parent, origin);\n          const node = shapeFunction(data, index);\n          const animation = updateFunction(data, [element], [node]);\n          if (animation !== null) return animation;\n          if (element.nodeName === node.nodeName && node.nodeName !== 'g') {\n            copyAttributes(element, node);\n          } else {\n            element.parentNode.replaceChild(node, element);\n            node.className = ELEMENT_CLASS_NAME;\n            // @ts-ignore\n            node.markType = type;\n            // @ts-ignore\n            node.__data__ = element.__data__;\n          }\n          return animation;\n        }).attr('markType', type).attr('className', ELEMENT_CLASS_NAME);\n      }), exit => {\n        return exit.each(function (d, i, element) {\n          element.__removed__ = true;\n        }).transition(function (data, i, element) {\n          return exitFunction(data, [element]);\n        }).remove();\n      }, merge => merge\n      // Append elements to be merged.\n      .append(shapeFunction).attr('className', ELEMENT_CLASS_NAME).attr('markType', type).transition(function (data, i, element) {\n        // Remove merged elements after animation finishing.\n        const {\n          __fromElements__: fromElements\n        } = element;\n        const transition = updateFunction(data, fromElements, [element]);\n        const exit = new Selection(fromElements, null, element.parentNode);\n        exit.transition(transition).remove();\n        return transition;\n      }), split => split.transition(function (data, i, element) {\n        // Append splitted shapes.\n        const enter = new Selection([], element.__toData__, element.parentNode);\n        const toElements = enter.append(shapeFunction).attr('className', ELEMENT_CLASS_NAME).attr('markType', type).nodes();\n        return updateFunction(data, [element], toElements);\n      })\n      // Remove elements to be splitted after animation finishing.\n      .remove()).transitions();\n      transitions.push(...T.flat());\n    }\n    // Plot label for this view.\n    plotLabel(view, selection, transitions, library, context);\n  });\n}\n/**\n * Auto hide labels be specify label layout.\n */\nfunction plotLabel(view, selection, transitions, library, context) {\n  const [useLabelTransform] = useLibrary('labelTransform', library);\n  const {\n    markState,\n    labelTransform\n  } = view;\n  const labelLayer = selection.select(className(LABEL_LAYER_CLASS_NAME)).node();\n  // A Map index shapeFunction by label.\n  const labelShapeFunction = new Map();\n  // A Map index options by label.\n  const labelDescriptor = new Map();\n  // Get all labels for this view.\n  const labels = Array.from(markState.entries()).flatMap(([mark, state]) => {\n    const {\n      labels: labelOptions = [],\n      key\n    } = mark;\n    const shapeFunction = createLabelShapeFunction(mark, state, view, library, context);\n    const elements = selection.select(`#${key}`).selectAll(className(ELEMENT_CLASS_NAME)).nodes()\n    // Only select the valid element.\n    .filter(n => !n.__removed__);\n    return labelOptions.flatMap((labelOption, i) => {\n      const {\n          transform = []\n        } = labelOption,\n        options = __rest(labelOption, [\"transform\"]);\n      return elements.flatMap(e => {\n        const L = getLabels(options, i, e);\n        L.forEach(l => {\n          labelShapeFunction.set(l, shapeFunction);\n          labelDescriptor.set(l, labelOption);\n        });\n        return L;\n      });\n    });\n  });\n  // Render all labels.\n  const labelShapes = select(labelLayer).selectAll(className(LABEL_CLASS_NAME)).data(labels, d => d.key).join(enter => enter.append(d => labelShapeFunction.get(d)(d)).attr('className', LABEL_CLASS_NAME), update => update.each(function (d, i, element) {\n    // @todo Handle Label with different type.\n    const shapeFunction = labelShapeFunction.get(d);\n    const node = shapeFunction(d);\n    copyAttributes(element, node);\n  }), exit => exit.remove()).nodes();\n  // Apply group-level transforms.\n  const labelGroups = group(labelShapes, d => labelDescriptor.get(d.__data__));\n  const {\n    coordinate\n  } = view;\n  const labelTransformContext = {\n    canvas: context.canvas,\n    coordinate\n  };\n  for (const [label, shapes] of labelGroups) {\n    const {\n      transform = []\n    } = label;\n    const transformFunction = compose(transform.map(useLabelTransform));\n    transformFunction(shapes, labelTransformContext);\n  }\n  // Apply view-level transform.\n  if (labelTransform) {\n    labelTransform(labelShapes, labelTransformContext);\n  }\n}\nfunction getLabels(label, labelIndex, element) {\n  const {\n    seriesIndex: SI,\n    seriesKey,\n    points,\n    key,\n    index\n  } = element.__data__;\n  const bounds = getLocalBounds(element);\n  if (!SI) {\n    return [Object.assign(Object.assign({}, label), {\n      key: `${key}-${labelIndex}`,\n      bounds,\n      index,\n      points,\n      dependentElement: element\n    })];\n  }\n  const selector = normalizeLabelSelector(label);\n  const F = SI.map((index, i) => Object.assign(Object.assign({}, label), {\n    key: `${seriesKey[i]}-${labelIndex}`,\n    bounds: [points[i]],\n    index,\n    points,\n    dependentElement: element\n  }));\n  return selector ? selector(F) : F;\n}\nfunction filterValid([I, P, S]) {\n  if (S) return [I, P, S];\n  const definedIndex = [];\n  const definedPoints = [];\n  for (let i = 0; i < I.length; i++) {\n    const d = I[i];\n    const p = P[i];\n    if (p.every(([x, y]) => defined(x) && defined(y))) {\n      definedIndex.push(d);\n      definedPoints.push(p);\n    }\n  }\n  return [definedIndex, definedPoints];\n}\nfunction normalizeLabelSelector(label) {\n  const {\n    selector\n  } = label;\n  if (!selector) return null;\n  if (typeof selector === 'function') return selector;\n  if (selector === 'first') return I => [I[0]];\n  if (selector === 'last') return I => [I[I.length - 1]];\n  throw new Error(`Unknown selector: ${selector}`);\n}\n/**\n * Avoid getting error bounds caused by element animations.\n * @todo Remove this temporary handle method, if runtime supports\n * correct process: drawElement, do label layout and then do\n * transitions together.\n */\nfunction getLocalBounds(element) {\n  const cloneElement = element.cloneNode();\n  const animations = element.getAnimations();\n  cloneElement.style.visibility = 'hidden';\n  animations.forEach(animation => {\n    const keyframes = animation.effect.getKeyframes();\n    cloneElement.attr(keyframes[keyframes.length - 1]);\n  });\n  element.parentNode.appendChild(cloneElement);\n  const bounds = cloneElement.getLocalBounds();\n  cloneElement.destroy();\n  const {\n    min,\n    max\n  } = bounds;\n  return [min, max];\n}\nfunction createLabelShapeFunction(mark, state, view, library, context) {\n  const [useShape] = useLibrary('shape', library);\n  const {\n    data: abstractData,\n    encode\n  } = mark;\n  const {\n    data: visualData,\n    defaultLabelShape\n  } = state;\n  const point2d = visualData.map(d => d.points);\n  const channel = mapObject(encode, d => d.value);\n  // Assemble Context.\n  const {\n    theme,\n    coordinate\n  } = view;\n  const shapeContext = Object.assign(Object.assign({}, context), {\n    document: documentOf(context),\n    theme,\n    coordinate\n  });\n  return options => {\n    // Computed values from data and styles.\n    const {\n      index,\n      points\n    } = options;\n    const datum = abstractData[index];\n    const {\n        formatter = d => `${d}`,\n        transform,\n        style: abstractStyle,\n        render\n      } = options,\n      abstractOptions = __rest(options, [\"formatter\", \"transform\", \"style\", \"render\"]);\n    const visualOptions = mapObject(Object.assign(Object.assign({}, abstractOptions), abstractStyle), d => valueOf(d, datum, index, abstractData, {\n      channel\n    }));\n    const {\n        shape = defaultLabelShape,\n        text\n      } = visualOptions,\n      style = __rest(visualOptions, [\"shape\", \"text\"]);\n    const f = typeof formatter === 'string' ? format(formatter) : formatter;\n    const value = Object.assign(Object.assign({}, style), {\n      text: f(text, datum, index, abstractData),\n      datum\n    });\n    // Params for create shape.\n    const shapeOptions = Object.assign({\n      type: `label.${shape}`,\n      render\n    }, style);\n    const shapeFunction = useShape(shapeOptions, shapeContext);\n    const defaults = getDefaultsStyle(theme, 'label', shape, 'label');\n    return shapeFunction(points, value, defaults, point2d);\n  };\n}\nfunction valueOf(value, datum, i, data, options) {\n  if (typeof value === 'function') return value(datum, i, data, options);\n  if (typeof value !== 'string') return value;\n  if (isStrictObject(datum) && datum[value] !== undefined) return datum[value];\n  return value;\n}\n/**\n * Compute max duration for this frame.\n */\nfunction computeAnimationExtent(markState) {\n  let maxDuration = -Infinity;\n  let minDelay = Infinity;\n  for (const [mark, state] of markState) {\n    const {\n      animate = {}\n    } = mark;\n    const {\n      data\n    } = state;\n    const {\n      enter = {},\n      update = {},\n      exit = {}\n    } = animate;\n    const {\n      type: defaultUpdateType,\n      duration: defaultUpdateDuration = 300,\n      delay: defaultUpdateDelay = 0\n    } = update;\n    const {\n      type: defaultEnterType,\n      duration: defaultEnterDuration = 300,\n      delay: defaultEnterDelay = 0\n    } = enter;\n    const {\n      type: defaultExitType,\n      duration: defaultExitDuration = 300,\n      delay: defaultExitDelay = 0\n    } = exit;\n    for (const d of data) {\n      const {\n        updateType = defaultUpdateType,\n        updateDuration = defaultUpdateDuration,\n        updateDelay = defaultUpdateDelay,\n        enterType = defaultEnterType,\n        enterDuration = defaultEnterDuration,\n        enterDelay = defaultEnterDelay,\n        exitDuration = defaultExitDuration,\n        exitDelay = defaultExitDelay,\n        exitType = defaultExitType\n      } = d;\n      if (updateType === undefined || updateType) {\n        maxDuration = Math.max(maxDuration, updateDuration + updateDelay);\n        minDelay = Math.min(minDelay, updateDelay);\n      }\n      if (exitType === undefined || exitType) {\n        maxDuration = Math.max(maxDuration, exitDuration + exitDelay);\n        minDelay = Math.min(minDelay, exitDelay);\n      }\n      if (enterType === undefined || enterType) {\n        maxDuration = Math.max(maxDuration, enterDuration + enterDelay);\n        minDelay = Math.min(minDelay, enterDelay);\n      }\n    }\n  }\n  if (maxDuration === -Infinity) return null;\n  return [minDelay, maxDuration - minDelay];\n}\nfunction selectFacetElements(selection, current, facetClassName, elementClassName) {\n  const group = selection.node().parentElement;\n  return group.findAll(node => node.style.facet !== undefined && node.style.facet === facetClassName && node !== current.node()).flatMap(node => node.getElementsByClassName(elementClassName));\n}\n/**\n * Update the parent of element and apply transform to make it\n * stay in original position.\n */\nfunction maybeFacetElement(element, parent, originOf) {\n  if (!element.__facet__) return;\n  // element -> g#main -> rect#plot\n  const prePlot = element.parentNode.parentNode;\n  // g#main -> rect#plot\n  const newPlot = parent.parentNode;\n  const [px, py] = originOf(prePlot);\n  const [x, y] = originOf(newPlot);\n  const translate = `translate(${px - x}, ${py - y})`;\n  appendTransform(element, translate);\n  parent.append(element);\n}\nfunction createMarkShapeFunction(mark, state, view, context) {\n  const {\n    library\n  } = context;\n  const [useShape] = useLibrary('shape', library);\n  const {\n    data: abstractData,\n    encode\n  } = mark;\n  const {\n    defaultShape,\n    data,\n    shape: shapeLibrary\n  } = state;\n  const channel = mapObject(encode, d => d.value);\n  const point2d = data.map(d => d.points);\n  const {\n    theme,\n    coordinate\n  } = view;\n  const {\n    type: markType,\n    style = {}\n  } = mark;\n  const shapeContext = Object.assign(Object.assign({}, context), {\n    document: documentOf(context),\n    coordinate,\n    theme\n  });\n  return data => {\n    const {\n      shape: styleShape = defaultShape\n    } = style;\n    const {\n        shape = styleShape,\n        points,\n        seriesIndex,\n        index: i\n      } = data,\n      v = __rest(data, [\"shape\", \"points\", \"seriesIndex\", \"index\"]);\n    const value = Object.assign(Object.assign({}, v), {\n      index: i\n    });\n    // Get data-driven style.\n    // If it is a series shape, such as area and line,\n    // provides the series of abstract data and indices\n    // for this shape, otherwise the single datum and\n    // index.\n    const abstractDatum = seriesIndex ? seriesIndex.map(i => abstractData[i]) : abstractData[i];\n    const I = seriesIndex ? seriesIndex : i;\n    const visualStyle = mapObject(style, d => valueOf(d, abstractDatum, I, abstractData, {\n      channel\n    }));\n    // Try get shape from mark first, then from library.\n    const shapeFunction = shapeLibrary[shape] ? shapeLibrary[shape](visualStyle, shapeContext) : useShape(Object.assign(Object.assign({}, visualStyle), {\n      type: shapeName(mark, shape)\n    }), shapeContext);\n    const defaults = getDefaultsStyle(theme, markType, shape, defaultShape);\n    return shapeFunction(points, value, defaults, point2d);\n  };\n}\nfunction getDefaultsStyle(theme, mark, shape, defaultShape) {\n  if (typeof mark !== 'string') return;\n  const {\n    color\n  } = theme;\n  const markTheme = theme[mark] || {};\n  const shapeTheme = markTheme[shape] || markTheme[defaultShape];\n  return Object.assign({\n    color\n  }, shapeTheme);\n}\nfunction createAnimationFunction(type, mark, state, view, library) {\n  var _a, _b;\n  const [, createShape] = useLibrary('shape', library);\n  const [useAnimation] = useLibrary('animation', library);\n  const {\n    defaultShape,\n    shape: shapeLibrary\n  } = state;\n  const {\n    theme,\n    coordinate\n  } = view;\n  const upperType = upperFirst(type);\n  const key = `default${upperType}Animation`;\n  // Get shape from mark first, then from library.\n  const {\n    [key]: defaultAnimation\n  } = ((_a = shapeLibrary[defaultShape]) === null || _a === void 0 ? void 0 : _a.props) || createShape(shapeName(mark, defaultShape)).props;\n  const {\n    [type]: defaultEffectTiming = {}\n  } = theme;\n  const animate = ((_b = mark.animate) === null || _b === void 0 ? void 0 : _b[type]) || {};\n  const context = {\n    coordinate\n  };\n  return (data, from, to) => {\n    const {\n      [`${type}Type`]: animation,\n      [`${type}Delay`]: delay,\n      [`${type}Duration`]: duration,\n      [`${type}Easing`]: easing\n    } = data;\n    const options = Object.assign({\n      type: animation || defaultAnimation\n    }, animate);\n    if (!options.type) return null;\n    const animateFunction = useAnimation(options, context);\n    const value = {\n      delay,\n      duration,\n      easing\n    };\n    const A = animateFunction(from, to, deepMix(defaultEffectTiming, value));\n    if (!Array.isArray(A)) return [A];\n    return A;\n  };\n}\nfunction createEnterFunction(mark, state, view, library) {\n  return createAnimationFunction('enter', mark, state, view, library);\n}\n/**\n * Animation will not cancel automatically, it should be canceled\n * manually. This is very important for performance.\n */\nfunction cancel(animation) {\n  animation.finished.then(() => {\n    animation.cancel();\n  });\n  return animation;\n}\nfunction createUpdateFunction(mark, state, view, library) {\n  return createAnimationFunction('update', mark, state, view, library);\n}\nfunction createExitFunction(mark, state, view, library) {\n  return createAnimationFunction('exit', mark, state, view, library);\n}\nfunction inferTheme(theme = {}) {\n  if (typeof theme === 'string') return {\n    type: theme\n  };\n  const {\n      type = 'light'\n    } = theme,\n    rest = __rest(theme, [\"type\"]);\n  return Object.assign(Object.assign({}, rest), {\n    type\n  });\n}\n/**\n * @todo Infer builtin tooltips.\n */\nfunction inferInteraction(view) {\n  const defaults = {\n    event: true,\n    tooltip: true,\n    // @todo Inferred by slider self.\n    sliderFilter: true,\n    legendFilter: true,\n    scrollbarFilter: true\n  };\n  const {\n    interaction = {}\n  } = view;\n  return Object.entries(deepMix(defaults, interaction)).reverse();\n}\nfunction applyTransform(node, context) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const {\n        data\n      } = node,\n      rest = __rest(node, [\"data\"]);\n    if (data == undefined) return node;\n    const [, {\n      data: newData\n    }] = yield applyDataTransform([], {\n      data\n    }, context);\n    return Object.assign({\n      data: newData\n    }, rest);\n  });\n}\nfunction updateBBox(selection) {\n  selection.style('transform', d => `translate(${d.paddingLeft + d.marginLeft}, ${d.paddingTop + d.marginTop})`).style('width', d => d.innerWidth).style('height', d => d.innerHeight);\n}\nfunction animateBBox(selection, extent) {\n  const [delay, duration] = extent;\n  selection.transition(function (data, i, element) {\n    const {\n      transform,\n      width,\n      height\n    } = element.style;\n    const {\n      paddingLeft,\n      paddingTop,\n      innerWidth,\n      innerHeight,\n      marginLeft,\n      marginTop\n    } = data;\n    const keyframes = [{\n      transform,\n      width,\n      height\n    }, {\n      transform: `translate(${paddingLeft + marginLeft}, ${paddingTop + marginTop})`,\n      width: innerWidth,\n      height: innerHeight\n    }];\n    return element.animate(keyframes, {\n      delay,\n      duration,\n      fill: 'both'\n    });\n  });\n}\nfunction shapeName(mark, name) {\n  const {\n    type\n  } = mark;\n  if (typeof name === 'string') return `${type}.${name}`;\n  return name;\n}\n/**\n * Create and update layer for each mark.\n * All the layers created here are treated as main layers.\n */\nfunction updateLayers(selection, marks) {\n  const facet = d => d.class !== undefined ? `${d.class}` : '';\n  // Skip for empty selection, it can't append nodes.\n  const nodes = selection.nodes();\n  if (nodes.length === 0) return;\n  selection.selectAll(className(MAIN_LAYER_CLASS_NAME)).data(marks, d => d.key).join(enter => enter.append('g').attr('className', MAIN_LAYER_CLASS_NAME).attr('id', d => d.key).style('facet', facet).style('fill', 'transparent').style('zIndex', d => {\n    var _a;\n    return (_a = d.zIndex) !== null && _a !== void 0 ? _a : 0;\n  }), update => update.style('facet', facet).style('fill', 'transparent').style('zIndex', d => {\n    var _a;\n    return (_a = d.zIndex) !== null && _a !== void 0 ? _a : 0;\n  }), exit => exit.remove());\n  const labelLayer = selection.select(className(LABEL_LAYER_CLASS_NAME)).node();\n  if (labelLayer) return;\n  selection.append('g').attr('className', LABEL_LAYER_CLASS_NAME).style('zIndex', 0);\n}\nfunction className(...names) {\n  return names.map(d => `.${d}`).join('');\n}\nfunction applyClip(selection, clip) {\n  if (!selection.node()) return;\n  selection.style('clipPath', data => {\n    if (!clip) return null;\n    const {\n      paddingTop: y,\n      paddingLeft: x,\n      marginLeft: x1,\n      marginTop: y1,\n      innerWidth: width,\n      innerHeight: height\n    } = data;\n    return new Rect({\n      style: {\n        x: x + x1,\n        y: y + y1,\n        width,\n        height\n      }\n    });\n  });\n}\nfunction inferComponentScales(scales, states, markState) {\n  // add shape scale to state.\n  var _a;\n  // for cell, omit shape scale.\n  // @todo support shape scale for cell.\n  for (const [key] of markState.entries()) {\n    if (key.type === 'cell') {\n      return scales.filter(scale => scale.name !== 'shape');\n    }\n  }\n  // can't infer shape scale if there are multiple states.\n  if (states.length !== 1 || scales.some(scale => scale.name === 'shape')) {\n    return scales;\n  }\n  const {\n    defaultShape: shape\n  } = states[0];\n  const acceptMarkTypes = ['point', 'line', 'rect', 'hollow'];\n  if (!acceptMarkTypes.includes(shape)) return scales;\n  const shapeMap = {\n    point: 'point',\n    line: 'hyphen',\n    rect: 'square',\n    hollow: 'hollow'\n  };\n  // create shape scale\n  const field = ((_a = scales.find(scale => scale.name === 'color')) === null || _a === void 0 ? void 0 : _a.field) || null;\n  const shapeScale = {\n    field,\n    name: 'shape',\n    type: 'constant',\n    domain: [],\n    range: [shapeMap[shape]]\n  };\n  return [...scales, shapeScale];\n}\nexport function applyStyle(selection, style) {\n  for (const [key, value] of Object.entries(style)) {\n    selection.style(key, value);\n  }\n}","map":{"version":3,"names":["Rect","deepMix","upperFirst","isArray","group","groups","format","mapObject","ChartEvent","isStrictObject","appendTransform","compose","copyAttributes","defined","error","maybeSubObject","subObject","useMemo","select","Selection","groupComponents","inferComponent","normalizeComponents","renderComponent","AREA_CLASS_NAME","COMPONENT_CLASS_NAME","ELEMENT_CLASS_NAME","LABEL_CLASS_NAME","LABEL_LAYER_CLASS_NAME","MAIN_LAYER_CLASS_NAME","PLOT_CLASS_NAME","VIEW_CLASS_NAME","coordinate2Transform","createCoordinate","computeLayout","computeRoughPlotSize","placeComponents","processAxisZ","documentOf","useLibrary","initializeMark","applyScale","assignScale","collectScales","inferScale","syncFacetsScales","useRelationScale","groupTransform","applyDataTransform","plot","options","selection","context","library","useComposition","useInteraction","marks","Set","Object","keys","map","d","_a","exec","filter","staticMarks","typeOf","node","type","props","composite","has","isMark","isStandardView","isStaticMark","transform","composition","static","views","viewNode","Map","nodeState","discovered","nodeGenerators","length","shift","state","get","view","children","initializeState","initializeView","set","push","transformedNodes","flatMap","every","states","Promise","all","initializeMarks","i","nodeT","n","applyTransform","N","Array","emitter","emit","BEFORE_PAINT","enterContainer","updateContainer","transitions","selectAll","className","data","key","join","enter","append","attr","call","applyTranslate","each","element","plotView","update","exit","interactions","values","interaction","destroy","remove","viewInstanceof","viewContainer","updateInteractions","oldStore","from","entries","container","store","setState","reducer","x","createUpdateView","updateTypes","__awaiter","newOptions","updateType","updateViewInstances","target","nameInteraction","typeOptions","inferInteraction","v","includes","typeOption","option","prevInteraction","useThemeInteraction","enterViewInstances","width","height","keyframes","nodeGenerator","keyframe","resolve","sizedNode","assign","animations","forEach","animation","cancel","AFTER_PAINT","finished","style","layout","y","definedInteraction","createInteraction","name","createDefinedInteraction","reapplyWhenUpdate","updates","source","callback","newView","newChildren","updateInteraction","child","interactionOptions","find","applyInteraction","flattenOptions","transformMarks","mergedOptions","bubbleOptions","coordinate","components","transformedOptions","viewCoordinate","viewInteraction","viewStyle","rest","__rest","markCoordinates","markInteractions","markViewStyles","newCoordinate","reduceRight","prev","cur","newInteraction","reduce","newStyle","useMark","createMark","flattenMarks","markOptions","splice","mark","newMark","value","M","unshift","useTheme","theme","partialTheme","partialMarks","coordinates","inferTheme","markState","markAndState","initializedMark","scaleChannels","channels","scaleKey","scaleOptions","total","scale","FV","fields","field","guide","title","undefined","uid","Symbol","channel","defaults","useLabelTransform","frame","clip","labelTransform","scales","inferComponentScales","framedStyle","mainLineWidth","mainStroke","uidScale","scaleInstance","component","scaleDescriptors","descriptor","getOptions","xScale","scaleInstances","createChildren","dataDomain","modifier","markKey","index","tooltip","fromEntries","markScaleInstance","calcPoints","I","P","S","filterValid","count","T","titleOf","_b","itemsOf","items","V","visualData","datum","points","viewKey","k","si","markChildren","areaKeys","_","sizeKeys","areaStyles","areaSizes","styleArea","areaLayouts","applyStyle","px","py","pw","ph","size","left","top","bottom","right","animationExtent","computeAnimationExtent","componentAnimateOptions","duration","C","position","componentsTransitions","zIndex","animate","transition","preserve","newComponent","attributes","childNodes","flat","updateBBox","updateLayers","applyClip","animateBBox","class","cls","shapeFunction","createMarkShapeFunction","enterFunction","createEnterFunction","updateFunction","createUpdateFunction","exitFunction","createExitFunction","facetElements","selectFacetElements","selectFacetAll","groupKey","parent","origin","getBounds","min","maybeFacetElement","nodeName","parentNode","replaceChild","markType","__data__","__removed__","merge","__fromElements__","fromElements","split","__toData__","toElements","nodes","plotLabel","labelLayer","labelShapeFunction","labelDescriptor","labels","labelOptions","createLabelShapeFunction","elements","labelOption","e","L","getLabels","l","labelShapes","labelGroups","labelTransformContext","canvas","label","shapes","transformFunction","labelIndex","seriesIndex","SI","seriesKey","bounds","getLocalBounds","dependentElement","selector","normalizeLabelSelector","F","definedIndex","definedPoints","p","Error","cloneElement","cloneNode","getAnimations","visibility","effect","getKeyframes","appendChild","max","useShape","abstractData","encode","defaultLabelShape","point2d","shapeContext","document","formatter","abstractStyle","render","abstractOptions","visualOptions","valueOf","shape","text","f","shapeOptions","getDefaultsStyle","maxDuration","Infinity","minDelay","defaultUpdateType","defaultUpdateDuration","delay","defaultUpdateDelay","defaultEnterType","defaultEnterDuration","defaultEnterDelay","defaultExitType","defaultExitDuration","defaultExitDelay","updateDuration","updateDelay","enterType","enterDuration","enterDelay","exitDuration","exitDelay","exitType","Math","current","facetClassName","elementClassName","parentElement","findAll","facet","getElementsByClassName","originOf","__facet__","prePlot","newPlot","translate","defaultShape","shapeLibrary","styleShape","abstractDatum","visualStyle","shapeName","color","markTheme","shapeTheme","createAnimationFunction","createShape","useAnimation","upperType","defaultAnimation","defaultEffectTiming","to","easing","animateFunction","A","then","event","sliderFilter","legendFilter","scrollbarFilter","reverse","newData","paddingLeft","marginLeft","paddingTop","marginTop","innerWidth","innerHeight","extent","fill","names","x1","y1","some","acceptMarkTypes","shapeMap","point","line","rect","hollow","shapeScale","domain","range"],"sources":["runtime/plot.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}